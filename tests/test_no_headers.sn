# Test response without calling text() which adds headers
import "../src/http/router"
import "../src/http/request"
import "../src/http/response"

fn homeHandler(req: HttpRequest): HttpResponse =>
    # Just return ok() without text() - no headers added
    var res: HttpResponse = HttpResponse.ok()
    res.body = "Direct body"
    return res

fn main(): void =>
    var router: Router = Router.new()
    router.get("/", homeHandler)

    var reqData: str = "GET / HTTP/1.1\r\nHost: localhost\r\n\r\n"
    var req: HttpRequest = HttpRequest.parse(reqData)

    var res: HttpResponse = router.handle(req)
    print($"Code: {res.statusCode}, Text: {res.statusText}\n")
    print($"Headers count: {res.headers.length}\n")
    print($"Body: {res.body}\n")
    print("\nFull response:\n")
    print(res.toString())
